name: Update Marine Forecast

on:
  schedule:
    - cron: "0 */3 * * *"   # de 3 em 3 horas
  workflow_dispatch: # Permite disparar manualmente

permissions:
  contents: write  # permite push para o repo

jobs:
  update-forecast:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Node.js (opcional, se fores gerar JSON via script)
        uses: actions/setup-node@v3
        with:
          node-version: '20'

      - name: Update forecast.json
        run: |
          # Aqui podes colocar um script para gerar forecast.json
          # Exemplo simples: copiar de outro local ou executar Node.js script
          echo "Gerando forecast.json..."
          node scripts/generate_forecast.js # se tiveres script
          # Ou, se j√° tens JSON pronto em outro lugar:
          # cp path/to/new_forecast.json docs/forecast.json

      - name: Commit changes
        run: |
          git config user.name "github-actions"
          git config user.email "actions@github.com"
          git add docs/forecast.json
          git diff --staged --quiet || git commit -m "Update forecast.json [skip ci]"
          git push
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
